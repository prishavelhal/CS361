<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Finance Dashboard</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <nav class="navigationbar">
        <ul class="linkstopage">
            <li><a href="index.html" title="You are currently on the Dashboard page.">Dashboard</a></li>
            <li><a href="expenses.html" title="Want to view your expenses in more detail and add new ones or edit current ones? Click on this link!">Expenses</a></li>
            <li><a href="income.html" title="Want to view your income in more detail and add more income or edit current ones? Click on this link!">Income</a></li>
        </ul>
    </nav>
<main>
    <h2>Dashboard</h2>
    <h4>Welcome to your finance dashboard!</h4>
    <p>Use this page to get a quick look at your finances OR Use the links in the nav bar to add income and expenses! Hover over the page names for Dashboard, Income, and Expenses, to learn more about each page before navigating!</p>
    <p>NOTE: Any data you enter will only be accessible by you to ensure your privacy. We do not track or store your data, it is solely for you.</p>
    <h3>Reminder</h3>
    <p id="reminder">Loading...</p>
    
    <div class="cards">
        <div class="card">
            <h3>Total Income</h3>
            <p id="dashboard-income"></p>
        </div>
        <div class="card">
            <h3>Total Expenses</h3>
            <p id="dashboard-expense"></p>
        </div>
        <div class="card">
            <h3>Net Balance</h3>
            <p id="net-balance-value">Loading...</p>
        </div>
        <div class="card">
            <h3>Savings Progress</h3>
            <div id="savings-progress" style="background-color: beige; border-radius: 5px; width: auto;">
                <div id="savings-progress-fill" style="background-color: #a03c3c; width: 0%; height: 20px; border-radius:5px"></div>
            </div>
            <p id="savings-text">Loading...</p>
        </div>
    </div>
    
    <h3></h3>
    <button onclick="logout()">Logout</button>
    
</main>

<script>
   document.addEventListener("DOMContentLoaded", function() {
    const incomeDashboard = localStorage.getItem("totalIncome");
    if (incomeDashboard) {
        document.getElementById("dashboard-income").textContent = `$${incomeDashboard}`;
    }
    const expenseDashboard = localStorage.getItem("totalExpense");
    if (expenseDashboard) {
        document.getElementById("dashboard-expense").textContent = `$${expenseDashboard}`;
    } else {
        document.getElementById("dashboard-expense").textContent = `$0.00`;
    }
 });

    //Login microservice
    document.addEventListener("DOMContentLoaded", function() {
        const user = localStorage.getItem("userId");
        if(!user){
            window.location.href = "login.html";
        }
    });

    //Reminder microservice
    function getReminder(){
        fetch("http://localhost:5001/notifications")
        .then(response => response.json())
        .then(data => {
            document.getElementById("reminder").textContent = data.notification;
        })
        .catch(error => {
            console.error("Error fetching reminder:", error);
            document.getElementById("reminder").textContent = "None";
        });
    }

    document.addEventListener("DOMContentLoaded", getReminder);

    //Logout
    function logout() {
        localStorage.removeItem("user");
        window.location.href = "login.html";
    }

    //Net Balance microservice
    document.addEventListener("DOMContentLoaded", function() {
        const income = parseFloat(localStorage.getItem("totalIncome")) || 0;
        const expense = parseFloat(localStorage.getItem("totalExpense")) || 0;

        document.getElementById("dashboard-income").textContent = `$${income.toFixed(2)}`;
        document.getElementById("dashboard-expense").textContent = `$${expense.toFixed(2)}`;

        fetch("http://localhost:5004/net", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ income, expenses: expense })
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("net-balance-value").textContent = `$${data.net.toFixed(2)}`;
        })
        .catch(error => {
            document.getElementById("net-balance-value").textContent = "Error calculating net balance";
            console.error("Error receiving net balance:", error);
        });
    });

    //Savings progress microservice
    fetch('http://localhost:5005/progress')
    .then(response => response.json())
    .then(data => {
        const progress = data.progress;
        document.getElementById("savings-progress-fill").style.width = `${progress}%`;
        document.getElementById("savings-text").textContent = `${data.goal_name} Progress: $${data.current_amount} of $${data.goal_amount} (${progress}%)`;
    })
    .catch(error => {
        document.getElementById("savings-text").textContent = "Error calculating savings progress";
        console.error("Error receiving savings progress:", error);
    });
</script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Dashboard</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
    <nav class="navigationbar">
        <div class="nav-container">
            <div class="linkstopage">
                <a href="index.html" class="nav-link active" title="You are currently on the Dashboard page.">
                    <span class="nav-icon">ðŸ“Š</span>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="expenses.html" class="nav-link" title="Want to view your expenses in more detail and add new ones or edit current ones? Click on this link!">
                    <span class="nav-icon">ðŸ’¸</span>
                    <span class="nav-text">Expenses</span>
                </a>
                <a href="income.html" class="nav-link" title="Want to view your income in more detail and add more income or edit current ones? Click on this link!">
                    <span class="nav-icon">ðŸ’µ</span>
                    <span class="nav-text">Income</span>
                </a>
            </div>
        </div>
    </nav>

    <main>
        <div class="dashboard-header">
            <h2>ðŸ’° Finance Dashboard</h2>
            <h4>Welcome to your finance dashboard!</h4>
            <p>Use this page to get a quick look at your finances OR Use the links in the nav bar to add income and expenses! Hover over the page names for Dashboard, Income, and Expenses, to learn more about each page before navigating!</p>
            <p>NOTE: Any data you enter will only be accessible by you to ensure your privacy. We do not track or store your data, it is solely for you.</p>
        </div>

        <div class="reminder-section">
            <h3>ðŸ’¡ Financial Reminder</h3>
            <p id="reminder">Loading...</p>
        </div>
        
        <div class="cards">
            <div class="card">
                <h3>Total Income</h3>
                <p id="dashboard-income">$0.00</p>
            </div>
            <div class="card">
                <h3>Total Expenses</h3>
                <p id="dashboard-expense">$0.00</p>
            </div>
            <div class="card">
                <h3>Net Balance</h3>
                <p id="net-balance-value">Loading...</p>
            </div>
            <div class="card">
                <h3>Savings Progress</h3>
                <div id="savings-progress">
                    <div id="savings-progress-fill" style="width: 0%"></div>
                </div>
                <p id="savings-text">Loading...</p>
            </div>
        </div>
        
        <div class="logout-section">
            <button onclick="logout()">ðŸšª Logout</button>
        </div>
    </main>

    <script>
       document.addEventListener("DOMContentLoaded", function() {
        const incomeDashboard = localStorage.getItem("totalIncome");
        if (incomeDashboard) {
            document.getElementById("dashboard-income").textContent = `$${incomeDashboard}`;
        } else {
            document.getElementById("dashboard-income").textContent = `$0.00`;
        }
        const expenseDashboard = localStorage.getItem("totalExpense");
        if (expenseDashboard) {
            document.getElementById("dashboard-expense").textContent = `$${expenseDashboard}`;
        } else {
            document.getElementById("dashboard-expense").textContent = `$0.00`;
        }
     });

        //Login microservice
        document.addEventListener("DOMContentLoaded", function() {
            const user = localStorage.getItem("userId");
            if(!user){
                window.location.href = "login.html";
            }
        });

        //Reminder microservice
        function getReminder(){
            fetch("http://localhost:5001/notifications")
            .then(response => response.json())
            .then(data => {
                document.getElementById("reminder").textContent = data.notification;
            })
            .catch(error => {
                console.error("Error fetching reminder:", error);
                document.getElementById("reminder").textContent = "Review your monthly budget and set savings goals!";
            });
        }

        document.addEventListener("DOMContentLoaded", getReminder);

        //Logout
        function logout() {
            localStorage.removeItem("user");
            window.location.href = "login.html";
        }

        //Net Balance microservice
        document.addEventListener("DOMContentLoaded", function() {
            const income = parseFloat(localStorage.getItem("totalIncome")) || 0;
            const expense = parseFloat(localStorage.getItem("totalExpense")) || 0;

            document.getElementById("dashboard-income").textContent = `$${income.toFixed(2)}`;
            document.getElementById("dashboard-expense").textContent = `$${expense.toFixed(2)}`;

            fetch("http://localhost:5004/net", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ income, expenses: expense })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("net-balance-value").textContent = `$${data.net.toFixed(2)}`;
            })
            .catch(error => {
                document.getElementById("net-balance-value").textContent = "Error calculating net balance";
                console.error("Error receiving net balance:", error);
            });
        });

        //Savings progress microservice
        fetch('http://localhost:5005/progress')
        .then(response => response.json())
        .then(data => {
            const progress = data.progress;
            document.getElementById("savings-progress-fill").style.width = `${progress}%`;
            document.getElementById("savings-progress-fill").textContent = `${progress}%`;
            document.getElementById("savings-text").textContent = `${data.goal_name} Progress: $${data.current_amount} of $${data.goal_amount} (${progress}%)`;
        })
        .catch(error => {
            document.getElementById("savings-text").textContent = "Error calculating savings progress";
            console.error("Error receiving savings progress:", error);
        });
    </script>
</body>
</html>